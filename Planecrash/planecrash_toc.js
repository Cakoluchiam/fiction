let toc_info = {
  "episodes": [{
    "episode_type": "Episode",
    "episode_id": "01",
    "episode_date": "2023-04-10",
    "contents": [{
      "header_level": 2,
      "header_type": "Volume",
      "index_id": "I",
      "title": "Mad Investor Chaos and the Woman of Asmodeus",
      "url": "IMSIYUDT_Week_1.htm#Volume-I",
      "contents": [{
        "header_none": true,
        "contents": [{
          "header_type": "Prologue",
          "title": "Planecrash",
          "url": "IMSIYUDT_Week_1.htm#Prologue"
        }]
      },
      {
        "header_level": 3,
        "header_type": "Book",
        "index_id": "One",
        "title": "Places-People-Go-When-They-Are-Dead",
        "url": "IMSIYUDT_Week_1.htm#Book-One",
        "contents": [{
          "header_type": "Chapter",
          "index_id": "1",
          "title": "Golarion",
          "url": "IMSIYUDT_Week_1.htm#Chapter-1"
        },
        {
          "header_type": "Chapter",
          "index_id": "2",
          "title": "Equilibrium",
          "url": "IMSIYUDT_Week_1.htm#Chapter-2"
        },
        {
          "header_type": "Chapter",
          "index_id": "3",
          "title": "Steel",
          "url": "IMSIYUDT_Week_1.htm#Chapter-3"
        },
        {
          "header_type": "Chapter",
          "index_id": "4",
          "title": "Infinite Possibility Space",
          "url": "IMSIYUDT_Week_1.htm#Chapter-4"
        }]
      }]
    }]
  },
  {
    "episode_type": "Episode",
    "episode_id": "02",
    "episode_date": "2023-04-17",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_none": true,
        "contents": [{
          "header_type": "Chapter",
          "index_id": "4.5",
          "title": "Oaths",
          "url": "IMSIYUDT_Week_2.htm#Chapter-4.5"
        },
        {
          "header_type": "Chapter",
          "index_id": "5",
          "title": "Surface Thoughts",
          "url": "IMSIYUDT_Week_2.htm#Chapter-5"
        },
        {
          "header_type": "Interlude",
          "index_id": "|",
          "title": "Environmentalized Intrinsics",
          "url": "IMSIYUDT_Week_2.htm#Interlude-1"
        },
        {
          "header_type": "Chapter",
          "index_id": "6",
          "title": "The True Meaning of Chaos",
          "url": "IMSIYUDT_Week_2.htm#Chapter-6"
        },
        {
          "header_type": "Chapter",
          "index_id": "7",
          "title": "Squirrel",
          "url": "IMSIYUDT_Week_2.htm#Chapter-7"
        },
        {
          "header_type": "Chapter",
          "index_id": "8",
          "title": "Presumption of Good Intentions",
          "url": "IMSIYUDT_Week_2.htm#Chapter-8"
        }]
      },
      {
        "header_level": 3,
        "header_type": "Book",
        "index_id": "Two",
        "title": "Customs",
        "url": "IMSIYUDT_Week_2.htm#Book-Two",
        "contents": [{
          "header_type": "Chapter",
          "index_id": "9",
          "title": "Syllables",
          "url": "IMSIYUDT_Week_2.htm#Chapter-9"
        }]
      }]
    }]
  },
  {
    "episode_type": "Episode",
    "episode_id": "03",
    "episode_date": "2023-04-24",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_none": true,
        "contents": [{
          "header_type": "Chapter",
          "index_id": "9.5",
          "title": "Lost in Translation",
          "url": "IMSIYUDT_Week_3.htm#Chapter-9.5"
        },
        {
          "header_type": "Chapter",
          "index_id": "10",
          "title": "Spilled Ink",
          "url": "IMSIYUDT_Week_3.htm#Chapter-10"
        },
        {
          "header_type": "Chapter",
          "index_id": "11",
          "title": "Common Knowledge",
          "url": "IMSIYUDT_Week_3.htm#Chapter-11"
        },
        {
          "header_type": "Chapter",
          "index_id": "12",
          "title": "Sources",
          "url": "IMSIYUDT_Week_3.htm#Chapter-12"
        },
        {
          "header_type": "Chapter",
          "index_id": "13",
          "title": "Seven",
          "url": "IMSIYUDT_Week_3.htm#Chapter-13"
        },
        {
          "header_type": "Chapter",
          "index_id": "14",
          "title": "Heresy",
          "url": "IMSIYUDT_Week_3.htm#Chapter-14"
        }]
      }]
    }]
  },
  {
    "episode_type": "Episode",
    "episode_id": "04",
    "episode_date": "2023-05-01",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_none": true,
        "contents": [{
          "header_type": "Interlude",
          "index_id": "||",
          "title": "They Never Listen",
          "url": "IMSIYUDT_Week_4.htm#Interlude-2"
        },
        {
          "header_type": "Chapter",
          "index_id": "15",
          "title": "Board of Coordination",
          "url": "IMSIYUDT_Week_4.htm#Chapter-15"
        },
        {
          "header_type": "Chapter",
          "index_id": "16",
          "title": "Topology",
          "url": "IMSIYUDT_Week_4.htm#Chapter-16"
        },
        {
          "header_type": "Chapter",
          "index_id": "17",
          "title": "Master-Criminal-Detective",
          "url": "IMSIYUDT_Week_4.htm#Chapter-17"
        },
        {
          "header_type": "Chapter",
          "index_id": "18",
          "title": "Mobility",
          "url": "IMSIYUDT_Week_4.htm#Chapter-18"
        },
        {
          "header_type": "Chapter",
          "index_id": "19",
          "title": "Thinking Quickly",
          "url": "IMSIYUDT_Week_4.htm#Chapter-19"
        },
        {
          "header_type": "Chapter",
          "index_id": "20",
          "title": "Going Meta",
          "url": "IMSIYUDT_Week_4.htm#Chapter-20"
        }]
      }]
    }]
  },
  {
    "episode_type": "Episode",
    "episode_id": "05",
    "episode_date": "2023-05-08",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_level": 3,
        "header_type": "Book",
        "index_id": "Three",
        "title": "Orientation",
        "url": "IMSIYUDT_Week_5.htm#Book-Three",
        "contents": [{
          "header_type": "Chapter",
          "index_id": "21",
          "title": "Sense Motive",
          "url": "IMSIYUDT_Week_5.htm#Chapter-21"
        },
        {
          "header_type": "Chapter",
          "index_id": "22",
          "title": "One Equals One",
          "url": "IMSIYUDT_Week_5.htm#Chapter-22"
        },
        {
          "header_type": "Chapter",
          "index_id": "23",
          "title": "Faster Than Hell",
          "url": "IMSIYUDT_Week_5.htm#Chapter-23"
        },
        {
          "header_type": "Interlude",
          "index_id": "|||",
          "title": "Syllogism",
          "url": "IMSIYUDT_Week_5.htm#Interlude-3"
        },
        {
          "header_type": "Chapter",
          "index_id": "24",
          "title": "Divergence",
          "url": "IMSIYUDT_Week_5.htm#Chapter-24"
        },
        {
          "header_type": "Interlude",
          "index_id": "||||",
          "title": "Building Blocks",
          "url": "IMSIYUDT_Week_5.htm#Interlude-4"
        },
        {
          "header_type": "Chapter",
          "index_id": "25",
          "title": "Shadows of Necessary Truths",
          "url": "IMSIYUDT_Week_5.htm#Chapter-25"
        },
        {
          "header_type": "Chapter",
          "index_id": "26",
          "title": "Absolute and Timeless Stuff",
          "url": "IMSIYUDT_Week_5.htm#Chapter-26"
        },
        {
          "header_type": "Chapter",
          "index_id": "27",
          "title": "Keepers",
          "url": "IMSIYUDT_Week_5.htm#Chapter-27"
        }]
      }]
    }]
  },
  {
    "episode_type": "Episode",
    "episode_id": "06",
    "episode_date": "2023-05-22",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_none": true,
        "contents": [{
          "header_type": "Chapter",
          "index_id": "27.5",
          "title": "The Fun Kind of Negotiation",
          "url": "IMSIYUDT_Week_6.htm#Chapter-27.5"
        }]
      },
      {
        "header_level": 3,
        "header_type": "Book",
        "index_id": "Four",
        "title": "Curriculum",
        "url": "IMSIYUDT_Week_6.htm#Book-Four",
        "contents": [{
          "header_type": "Chapter",
          "index_id": "28",
          "title": "Lunch",
          "url": "IMSIYUDT_Week_6.htm#Chapter-28"
        },
        {
          "header_type": "Chapter",
          "index_id": "29",
          "title": "Variance",
          "url": "IMSIYUDT_Week_6.htm#Chapter-29"
        },
        {
          "header_type": "Chapter",
          "index_id": "30",
          "title": "Variants",
          "url": "IMSIYUDT_Week_6.htm#Chapter-30"
        },
        {
          "header_type": "Chapter",
          "index_id": "31",
          "title": "Dignity, Dignity, and Dignity",
          "url": "IMSIYUDT_Week_6.htm#Chapter-31"
        }]
      }]
    }]
  },
  {
    "episode_type": "Episode",
    "episode_id": "07",
    "episode_date": "2023-05-29",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_none": true,
        "contents": [{
          "header_type": "Chapter",
          "index_id": "32",
          "title": "A Balancing Point of Pressures",
          "url": "IMSIYUDT_Week_7.htm#Chapter-32"
        },
        {
          "header_type": "Chapter",
          "index_id": "33",
          "title": "Smallness and Irrelevance",
          "url": "IMSIYUDT_Week_7.htm#Chapter-33"
        },
        {
          "header_type": "Chapter",
          "index_id": "34",
          "title": "Two-Step",
          "url": "IMSIYUDT_Week_7.htm#Chapter-34"
        },
        {
          "header_type": "Chapter",
          "index_id": "35",
          "title": "Games",
          "url": "IMSIYUDT_Week_7.htm#Chapter-35"
        },
        {
          "header_type": "Chapter",
          "index_id": "36",
          "title": "Good Times",
          "url": "IMSIYUDT_Week_7.htm#Chapter-36"
        },
        {
          "header_type": "Chapter",
          "index_id": "37",
          "title": "Diversity and Optimality",
          "url": "IMSIYUDT_Week_7.htm#Chapter-37"
        },
        {
          "header_type": "Interlude",
          "index_id": "卌",
          "title": "–",
          "url": "IMSIYUDT_Week_7.htm#Interlude-5"
        },
        {
          "header_type": "Chapter",
          "index_id": "38",
          "title": "The Optimal Best Solution",
          "url": "IMSIYUDT_Week_7.htm#Chapter-38"
        }]
      }]
    }]
  },
  {
    "episode_type": "Episode",
    "episode_id": "08",
    "episode_date": "2023-06-05",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_level": 3,
        "header_type": "Book",
        "index_id": "Five",
        "title": "Obedience",
        "url": "IMSIYUDT_Week_8.htm#Book-Five",
        "contents": [{
          "header_type": "Chapter",
          "index_id": "39",
          "title": "Punitive Secrets",
          "url": "IMSIYUDT_Week_8.htm#Chapter-39"
        },
        {
          "header_type": "Chapter",
          "index_id": "40",
          "title": "The Letter",
          "url": "IMSIYUDT_Week_8.htm#Chapter-40"
        },
        {
          "header_type": "Interlude",
          "index_id": "卌|",
          "title": "Ten Minutes",
          "url": "IMSIYUDT_Week_8.htm#Interlude-6"
        },
        {
          "header_type": "Chapter",
          "index_id": "41",
          "title": "The Spirit",
          "url": "IMSIYUDT_Week_8.htm#Chapter-41"
        }]
      }]
    }]
  },
  {
    "episode_type": "Episode",
    "episode_id": "09",
    "episode_date": "2023-06-12",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_none": true,
        "contents": [{
          "header_type": "Chapter",
          "index_id": "41.5",
          "title": "Reassurance",
          "url": "IMSIYUDT_Week_9.htm#Chapter-41.5"
        },
        {
          "header_type": "Chapter",
          "index_id": "42",
          "title": "Deterministic and Fully Visible",
          "url": "IMSIYUDT_Week_9.htm#Chapter-42"
        },
        {
          "header_type": "Chapter",
          "index_id": "43",
          "title": "Eagle's Splendour",
          "url": "IMSIYUDT_Week_9.htm#Chapter-43"
        },
        {
          "header_type": "Chapter",
          "index_id": "44",
          "title": "Owl's Wisdom",
          "url": "IMSIYUDT_Week_9.htm#Chapter-44"
        },
        {
          "header_type": "Chapter",
          "index_id": "45",
          "title": "A Nontrivial Price",
          "url": "IMSIYUDT_Week_9.htm#Chapter-45"
        },
        {
          "header_type": "Chapter",
          "index_id": "46",
          "title": "Leverage",
          "url": "IMSIYUDT_Week_9.htm#Chapter-46"
        }]
      }]
    }]
  },
  {
    "episode_type": "Episode",
    "episode_id": "10",
    "episode_date": "2023-06-26",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_level": 3,
        "header_type": "Book",
        "index_id": "Six",
        "title": "Consent",
        "url": "IMSIYUDT_Week_10.htm#Book-Six",
        "contents": [{
          "header_type": "Chapter",
          "index_id": "47",
          "title": "What Can Be Destroyed by the Truth",
          "url": "IMSIYUDT_Week_10.htm#Chapter-47"
        },
        {
          "header_type": "Chapter",
          "index_id": "48",
          "title": "A Temporal Process With Two Sides Where Each Side Is Composed of People Who Each Have Their Own Incentives Such That Each Side Is in Equilibrium With Respect to the Incentives Given to Them by the Other Side",
          "url": "IMSIYUDT_Week_10.htm#Chapter-48"
        },
        {
          "header_type": "Chapter",
          "index_id": "49",
          "title": "Oops It's Time to Overthrow the Government",
          "url": "IMSIYUDT_Week_10.htm#Chapter-49"
        },
        {
          "header_type": "Chapter",
          "index_id": "50",
          "title": "Spoilers",
          "url": "IMSIYUDT_Week_10.htm#Chapter-50"
        },
        {
          "header_type": "Chapter",
          "index_id": "51",
          "title": "Constellation",
          "url": "IMSIYUDT_Week_10.htm#Chapter-51"
        },
        {
          "header_type": "Chapter",
          "index_id": "52",
          "title": "Expectations",
          "url": "IMSIYUDT_Week_10.htm#Chapter-52"
        }]
      }]
    }]
  },
  {
    "episode_type": "Episode",
    "episode_id": "11",
    "episode_date": "2023-07-03",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_none": true,
        "contents": [{
          "header_type": "Chapter",
          "index_id": "53",
          "title": "To Delight in Tyranny",
          "url": "IMSIYUDT_Week_11.htm#Chapter-53"
        },
        {
          "header_type": "Chapter",
          "index_id": "54",
          "title": "Responsibility",
          "url": "IMSIYUDT_Week_11.htm#Chapter-54"
        },
        {
          "header_type": "Chapter",
          "index_id": "55",
          "title": "Fox's Cunning",
          "url": "IMSIYUDT_Week_11.htm#Chapter-55"
        },
        {
          "header_type": "Chapter",
          "index_id": "56",
          "title": "Social Deception",
          "url": "IMSIYUDT_Week_11.htm#Chapter-56"
        }]
      }]
    }]
  },
  {
    "episode_type": "Episode",
    "episode_id": "12",
    "episode_date": "2023-07-10",
    "episode_comment": "Final IMSIYUDT",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_level": 3,
        "header_type": "Book",
        "index_id": "Seven",
        "title": "Kissing Is Not a Human Universal",
        "comment": "nsfw",
        "url": "IMSIYUDT_Week_12.htm#Book-Seven",
        "contents": [{
          "header_type": "Chapter",
          "index_id": "57",
          "title": "The Standard Lattice"
        },
        {
          "header_type": "Chapter",
          "index_id": "58",
          "title": "Preflight Checklist"
        },
        {
          "header_type": "Chapter",
          "index_id": "59",
          "title": "Overthinking Things"
        },
        {
          "header_type": "Chapter",
          "index_id": "60",
          "title": "Stakes"
        },
        {
          "header_type": "Interlude",
          "index_id": "卌||",
          "title": "The Crucifixion Conditional"
        },
        {
          "header_type": "Chapter",
          "index_id": "61",
          "title": "Voluntary Servitude"
        },
        {
          "header_type": "Chapter",
          "index_id": "62",
          "title": "Good Lies Are Personal"
        },
        {
          "header_type": "Chapter",
          "index_id": "63",
          "title": "When You Will Survive Anything"
        },
        {
          "header_type": "Chapter",
          "index_id": "64",
          "title": "Head in the Game"
        }]
      }]
    }]
  },
  {
    "episode_type": "👯‍♀️",
    "episode_id": "s03e03",
    "episode_date": "2023-08-23",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_level": 3,
        "header_type": "Book",
        "index_id": "Eight",
        "title": "Revelations",
        "url": "WWBE_WWHB_s03e03.htm#Book-Eight",
        "contents": [{
          "header_type": "Chapter",
          "index_id": "65",
          "title": "Thoughts and Prayers",
          "url": "WWBE_WWHB_s03e03.htm#Chapter-65"
        },
        {
          "header_type": "Chapter",
          "index_id": "66",
          "title": "a/s/l",
          "url": "WWBE_WWHB_s03e03.htm#Chapter-66"
        },
        {
          "header_type": "Chapter",
          "index_id": "67",
          "title": "Errors in Favor",
          "url": "WWBE_WWHB_s03e03.htm#Chapter-67"
        },
        {
          "header_type": "Chapter",
          "index_id": "68",
          "title": "Planning Ahead",
          "url": "WWBE_WWHB_s03e03.htm#Chapter-68"
        },
        {
          "header_type": "Chapter",
          "index_id": "69",
          "title": "Revealed Preferences",
          "url": "WWBE_WWHB_s03e03.htm#Chapter-69"
        },
        {
          "header_type": "Chapter",
          "index_id": "70",
          "title": "Oops.",
          "url": "WWBE_WWHB_s03e03.htm#Chapter-70"
        },
        {
          "header_type": "Chapter",
          "index_id": "71",
          "title": "Glimpses of Visions",
          "url": "WWBE_WWHB_s03e03.htm#Chapter-71"
        },
        {
          "header_type": "Chapter",
          "index_id": "72",
          "title": "Correction",
          "url": "WWBE_WWHB_s03e03.htm#Chapter-72"
        },
        {
          "header_type": "Interlude",
          "index_id": "卌|||",
          "title": "Vocabulary",
          "url": "WWBE_WWHB_s03e03.htm#Interlude-8"
        },
        {
          "header_type": "Chapter",
          "index_id": "73",
          "title": "Syntax",
          "url": "WWBE_WWHB_s03e03.htm#Chapter-73"
        },
        {
          "header_type": "Chapter",
          "index_id": "74",
          "title": "Partners",
          "url": "WWBE_WWHB_s03e03.htm#Chapter-74"
        }]
      }]
    }]
  },
  {
    "episode_type": "👯‍♀️",
    "episode_id": "s03e04",
    "episode_date": "2023-08-28",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_level": 3,
        "header_type": "Book",
        "index_id": "Nine",
        "title": "Communication",
        "url": "WWBE_WWHB_s03e04.htm#Book-Nine",
        "contents": [{
          "header_type": "Chapter",
          "index_id": "75",
          "title": "Concealment",
          "url": "WWBE_WWHB_s03e04.htm#Chapter-75"
        },{
          "header_type": "Chapter",
          "index_id": "76",
          "title": "To Take What You Want",
          "url": "WWBE_WWHB_s03e04.htm#Chapter-76"
        },{
          "header_type": "Chapter",
          "index_id": "77",
          "title": "Nest of Snakes",
          "url": "WWBE_WWHB_s03e04.htm#Chapter-77"
        },{
          "header_type": "Chapter",
          "index_id": "78",
          "title": "Additional Questions",
          "url": "WWBE_WWHB_s03e04.htm#Chapter-78"
        },{
          "header_type": "Chapter",
          "index_id": "79",
          "title": "Dramatis Personae",
          "url": "WWBE_WWHB_s03e04.htm#Chapter-79"
        },{
          "header_type": "Chapter",
          "index_id": "80",
          "title": "Bounties",
          "url": "WWBE_WWHB_s03e04.htm#Chapter-80"
        }]
      }]
    }]
  },
  {
    "episode_type": "👯‍♀️",
    "episode_id": "s03e06",
    "episode_date": "2023-09-11",
    "episode_comment": "Current",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_level": 3,
        "header_type": "Book",
        "index_id": "Ten",
        "title": "Trade",
        "url": "WWBE_WWHB_s03e06.htm#Book-Ten",
        "contents": [{
          "header_type": "Interlude",
          "index_id": "卌||||",
          "title": "Backstory",
          "url": "WWBE_WWHB_s03e06.htm#Interlude-9"
        },{
          "header_type": "Chapter",
          "index_id": "81",
          "title": "Contact With the Enemy",
          "url": "WWBE_WWHB_s03e06.htm#Chapter-81"
        },{
          "header_type": "Chapter",
          "index_id": "82",
          "title": "Fairness",
          "url": "WWBE_WWHB_s03e06.htm#Chapter-82"
        },{
          "header_type": "Interlude",
          "index_id": "◻",
          "title": "Financial Literacy Level 2",
          "url": "WWBE_WWHB_s03e06.htm#Interlude-10"
        },{
          "header_type": "Chapter",
          "index_id": "83",
          "title": "Triangle Trade",
          "url": "WWBE_WWHB_s03e06.htm#Chapter-83"
        },{
          "header_type": "Chapter",
          "index_id": "84",
          "title": "Shoes",
          "url": "WWBE_WWHB_s03e06.htm#Chapter-84"
        },{
          "header_type": "Chapter",
          "index_id": "85",
          "title": "Something Publicly Observable",
          "url": "WWBE_WWHB_s03e06.htm#Chapter-85"
        },{
          "header_type": "Chapter",
          "index_id": "86",
          "title": "Implicit Favors",
          "url": "WWBE_WWHB_s03e06.htm#Chapter-86"
        },{
          "header_type": "Chapter",
          "index_id": "87",
          "title": "An Ideal-Agent Calculation Whose Naked Specification Is Too Large for Even Gods to Compute",
          "url": "WWBE_WWHB_s03e06.htm#Chapter-87"
        }]
      }]
    }]
  },
  {
    "episode_type": "Unassigned",
    "contents": [{
      "header_none": true,
      "contents": [{
        "header_none": true,
        "contents": [{
          "header_type": "Unindexed",
          "url": "IMSIYUDT_Unassigned.htm#Chapter-84"
        }]
      }]
    }]
  }]
}

function build_toc(contents) {
  if (!Array.isArray(contents)) return;
  let toc_list = document.createElement("ul");
  toc_list.style.listStyleType = "none";
  for(let entry of contents) {
    if(entry.header_none !== true) {
      let entry_elem = document.createElement("li");
      let current_el = entry_elem;
      if(entry.header_level !== undefined) {
        current_el.appendChild(document.createElement(`h${entry.header_level}`));
        current_el = current_el.firstChild;
      }
      if(entry.url !== undefined) {
        current_el.appendChild(document.createElement("a"));
        current_el = current_el.firstChild;
        current_el.href = entry.url;
      }
      if(entry.header_type !== undefined) current_el.innerHTML = `${entry.header_type}`;
      if(entry.index_id !== undefined) current_el.innerHTML += ` ${entry.index_id}`;
      if(entry.url !== undefined) current_el = current_el.parentElement;
      if(entry.title !== undefined) {
        current_el.innerHTML += ": ";
        let title = document.createElement("span");
        let hlevel = entry.header_type.toLowerCase();
        if(hlevel == "prologue" || hlevel == "interlude") hlevel = "chapter";
        title.classList.add("censored");
        title.classList.add(`${hlevel}-title`);
        title.innerHTML = `${entry.title}`;
        current_el.appendChild(title);
      }
      if(entry.comment !== undefined) current_el.innerHTML += ` (${entry.comment})`;
      toc_list.appendChild(entry_elem);
    }
    if(entry.contents !== undefined) {
      toc_list.appendChild(build_toc(entry.contents));
    }
  }
  return toc_list;
}

let toc_element = document.getElementById("toc_placeholder");
let open_week = Number(toc_element.getAttribute("open_week"));
let page_title = document.getElementById("page-title");
let week_number = document.getElementById("week_number");
if (open_week == 0) {
  open_week += toc_info.episodes.length;
  page_title.innerText="👯‍♀️ WWHB Unassigned";
  week_number.innerText = "Unassigned Reading";
}
else if (open_week == 12) {
  week_number.innerText = "Week "+open_week+" Reading";
}
else if (open_week < 12) {
  page_title.innerText = "IMSIYUDT Week "+open_week;
  week_number.innerText = "Week "+open_week+" Reading";
} else {
  page_title.innerText="👯‍♀️ WWHB Episode "+(open_week-11);
  week_number.innerText = "Episode "+(open_week-11)+" Reading";
}
for(let ep of toc_info.episodes) {
  episode_title = ep.episode_type
  if (ep.episode_id !== undefined) episode_title += " " + ep.episode_id;
  if (ep.episode_date !== undefined) episode_title += " – " + ep.episode_date;
  if (ep.episode_comment !== undefined) episode_title += " (" + ep.episode_comment + ")";
  let episode_entry = document.createElement("details");
  episode_entry.appendChild(document.createElement("summary"));
  episode_entry.firstChild.innerHTML = episode_title;
  episode_entry.appendChild(build_toc(ep.contents));
  // console.log(open_week);
  if(--open_week == 0) {
    episode_entry.toggleAttribute("open");
    episode_entry.setAttribute("id", "toc_current");
  } else if (open_week == -1) {
    // Add a link to the next week, if possible!
    console.log("Next Week!");
    let link = episode_entry.firstChild; //after <summary>
    while (link && link.nodeName != "A" && link.nodeName != "a") {
      if(link.nodeName == "SUMMARY" || link.nodeName == "summary") {
        link = link.nextSibling;
      } else {
        link = link.firstChild;
      }
    }
    console.log("Link:");
    console.log(link);
    if(link) {
      link = link.cloneNode();
      link.innerText = "next episode";
      nextEpisode = document.createElement("div");
      nextEpisode.innerHTML = "[ "+link.outerHTML+" ]";
      nextEpisode.style.float = "right";
      
      let content = document.getElementById("content");
      let lastElement = content.lastChild;
      console.log("lastElement:");
      console.log(lastElement);
      while (lastElement.nodeName == "#TEXT" || lastElement.nodeName == "#text") {
        lastElement = lastElement.previousSibling;
        console.log("...following:");
        console.log(lastElement);
      }

      // Remove space
      if((lastElement.nodeName == "div" ||
          lastElement.nodeName == "DIV") &&
        lastElement.innerText == "") {
        content.removeChild(lastElement); // trade with below
      }
      // Add space
      // if(lastElement.nodeName == "details" ||
      //   lastElement.nodeName == "DETAILS") {
      //   let spacer = document.createElement("div");
      //   spacer.style.height = "2em";
      //   content.appendChild(spacer); // trade with above
      // }
      content.appendChild(nextEpisode);
    }
  }
  toc_element.appendChild(episode_entry);
}